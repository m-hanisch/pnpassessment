<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Configure authentication | Microsoft 365 Assessment Tool </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Configure authentication | Microsoft 365 Assessment Tool ">
    <meta name="generator" content="docfx 2.56.5.0">
    <meta name="description" content="The Microsoft 365 SharePoint Assessment tool is enabling various deprecation and adoption scenarios by enabling you to assess your tenant.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/pnpassessment/blob/main/docs/using-the-assessment-tool/setupauth.md/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="configure-authentication">Configure authentication</h1>

<p>The Microsoft 365 Assessment tool uses Azure AD based authentication and requires a configured Azure AD application to run. The Microsoft 365 Assessment tool supports both application permissions (app-only) and delegated (user) permissions and various ways to authenticate.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>If you want the assessment tool to read all sites in your tenant then using application permissions is strongly recommended as that's the only way to guarantee that the Microsoft 365 Assessment tool can read all the sites. When you want to only assess a couple of sites and your account has permissions to these sites then using delegated permissions is an option.</p>
</div>
<h2 id="setting-up-the-azure-ad-application">Setting up the Azure AD application</h2>
<p>A configured Azure AD application is a pre-requisite for using the Microsoft 365 Assessment tool. When you <a href="assess-start.html">start an assessment</a> you'll be able to specify the Azure AD application to use and how you want to authenticate. When you don't specify an Azure AD application when starting an assessment the <strong>PnP Management Shell</strong> application will be assumed, if you're using a recent <a href="https://pnp.github.io/powershell/">PnP PowerShell</a> version then this application most likely was setup.</p>
<div class="NOTE">
<h5>Note</h5>
<p>It's strongly recommended to create a dedicated Azure AD application so you can limit the needed permissions to what's needed by the module you're using in the Microsoft 365 Assessment tool.</p>
</div>
<h3 id="permissions-required">Permissions required</h3>
<p>The Microsoft 365 Assessment tool aims to be able to perform the assessment task at hand using minimal read permissions, but for certain assessments not all features work when using minimal permissions. To understand which Microsoft Graph and SharePoint permissions are required please checkout the permission requirements of the respective modules.</p>
<ul>
<li><a href="../sharepoint-syntex/requirements.html">SharePoint Syntex adoption</a></li>
</ul>
<h3 id="creating-an-azure-ad-application-using-pnp-powershell">Creating an Azure AD application using PnP PowerShell</h3>
<p>Using <a href="https://pnp.github.io/powershell/">PnP PowerShell</a> creating an Azure AD application becomes really simple. Below cmdlet will create a new Azure AD application, will create a new self-signed certificate and will hookup that cert with the created Azure AD application. Finally the right permissions are configured and you're prompted to consent these permissions.</p>
<div class="IMPORTANT">
<h5>Important</h5>
<p>If you encounter errors during below steps it's likely that you do not have the needed permissions. Please contact your tenant / Azure AD admins for help.</p>
</div>
<pre><code class="lang-PowerShell"># Sample for the SharePoint Syntex adoption module
Register-PnPAzureADApp -ApplicationName Microsoft365AssessmentToolForSyntex `
                       -Tenant contoso.onmicrosoft.com `
                       -Store CurrentUser `
                       # Keep these if you want to use application permissions
                       -GraphApplicationPermissions &quot;Sites.Read.All&quot; `
                       -SharePointApplicationPermissions &quot;Sites.FullControl.All&quot; `
                       # Keep these if you want to use delegated permissions
                       -GraphDelegatePermissions &quot;Sites.Read.All&quot;, &quot;User.Read&quot; `
                       -SharePointDelegatePermissions &quot;AllSites.Manage&quot; `
                       -Username &quot;joe@contoso.onmicrosoft.com&quot; `
                       -Interactive
</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>Replace contoso.onmicrosoft.com with your Azure AD tenant name and ensure you replace joe@contoso.onmicrosoft.com with the user id that's an Azure AD admin (or global admin)</p>
</div>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <span>Microsoft 365 Assessment Tool<br>Generated by <strong><a href='https://dotnet.github.io/docfx' alt='Doc FX Website'>DocFX</a></strong> with <strong><a href='https://ovasquez.github.io/docfx-material' alt='DocFx Material Theme'>Material UI</a></strong></span>
            
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>